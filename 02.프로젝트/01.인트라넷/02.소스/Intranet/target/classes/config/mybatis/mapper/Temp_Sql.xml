<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="temp">
	<resultMap type="HashMap" id="getTempInfo">
		<result property="templateCd" 			column="TEMPLATE_CD"/>
		<result property="templateNm" 		column="TEMPLATE_NM"/>
		<result property="templateCont" 		column="TEMPLATE_CONT" jdbcType="CLOB" javaType="java.lang.String" />
	</resultMap>

	<select id="intrTempInqy1011" resultType="CamelHashMap" parameterType="java.util.HashMap">
		/* intrTempInqy1011 : 기안문 양식 목록 조회 */
		SELECT 
				T.TEMPLATE_CD
	        ,   T.TEMPLATE_NM
	        ,   T.DISP_ORDER
	        ,   T.REMARK
	        ,	'1' AS LV
	        ,	'Y' AS ISLEAF
		FROM TEMPLATE T
		WHERE 1=1
	</select>
	
	<select id="intrTempInqy1021" resultType="CamelHashMap" parameterType="java.util.HashMap" resultMap="getTempInfo">
		/* intrTempInqy1021 : 기안문 양식 상세 조회 */
		SELECT 
				T.TEMPLATE_CD
	        ,   T.TEMPLATE_NM
	        ,	T.TEMPLATE_CONT
		FROM TEMPLATE T
		WHERE 1=1
			AND T.TEMPLATE_CD = #{templateCd, jdbcType=VARCHAR}
	</select>
	
	<insert id="intrTempProc1011" parameterType="java.util.HashMap">
		/* intrTempProc1011 : 기안문 양식 등록 처리 */
		INSERT INTO TEMPLATE
		(
				TEMPLATE_CD
			,	TEMPLATE_NM
			,	TEMPLATE_CONT
			,	DISP_ORDER
			,	REMARK
		)
		VALUES
		(
				(SELECT 
					'TEMP_' || LPAD(NVL(MAX(SUBSTR(TEMPLATE_CD,LENGTH(TEMPLATE_CD)-3,LENGTH(TEMPLATE_CD))),0) + 1,4,0) AS TEMPLATE_CD 
				FROM TEMPLATE)
			,	#{templateNm, jdbcType=VARCHAR}
			,	#{templateCont, jdbcType=VARCHAR}
			,	(
					SELECT 
						NVL(MAX(DISP_ORDER),0) + 1 
					FROM TEMPLATE
				)
			,	NULL
		)
	</insert>

	<update id="intrTempProc1021" parameterType="java.util.HashMap">
		/* intrTempProc1021 : 기안문 양식 수정 처리 */
		UPDATE TEMPLATE
			SET		TEMPLATE_NM = #{templateNm, jdbcType=VARCHAR}
					,	TEMPLATE_CONT = #{templateCont, jdbcType=VARCHAR}
		WHERE TEMPLATE_CD = #{templateCd, jdbcType=VARCHAR}
	</update>
	
	<delete id="intrTempProc1031" parameterType="java.util.HashMap">
		/* intrTempProc1031 : 기안문 양식 삭제 처리 */
		DELETE FROM TEMPLATE
			WHERE TEMPLATE_CD = #{templateCd, jdbcType=VARCHAR}
	</delete>
</mapper>